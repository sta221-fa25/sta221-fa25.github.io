---
title: "Homework 02: properties of linear regression"
subtitle: "Due Friday September 26 at 5:00pm"
format: html
bibliography: references.bib
embed-resources: true
---

\newcommand{\bbeta}{\boldsymbol{\beta}}
\newcommand{\by}{\boldsymbol{y}}
\newcommand{\hby}{\hat{\boldsymbol{y}}}
\newcommand{\bone}{\boldsymbol{1}}
\newcommand{\bx}{\boldsymbol{x}}
\newcommand{\bX}{\boldsymbol{X}}
\newcommand{\be}{\boldsymbol{\varepsilon}}
\newcommand{\hbe}{\hat{\be}}
\newcommand{\bA}{\boldsymbol{A}}
\newcommand{\bzero}{\boldsymbol{0}}
\newcommand{\identity}{\boldsymbol{I}}
\newcommand{\hatMatrix}{\boldsymbol{H}}

# Conceptual exercises

The conceptual exercises are focused on explaining concepts and showing results mathematically. Show your work for each question.

You may write the answers and associated work for conceptual exercises by hand or type them in a Quarto document. Note: there is no GitHub repository for this assignment since there are no coding exercises.

In all exercises below, you may assume $E[\be | \bX] = \bzero$ and $\text{cov}(\be | \bX) = \sigma^2 \identity$.

## Exercise 1

In lecture, we defined the hat matrix $\hatMatrix$ as a projection matrix that projects $\by$ onto $Col(\bX)$ and discussed the properties of a projection matrix. In class we showed that $\hatMatrix$ is symmetric and idempotent. Now we will focus on two other properties.

(a) Show that for any vector $\boldsymbol{v}$ in $Col(\bX)$. $\hatMatrix \boldsymbol{v} = \boldsymbol{v}$.

(b) Show that any vector $\boldsymbol{v}$ orthogonal to $Col(\bX)$, $\hatMatrix \boldsymbol{v} = \bzero$

## Exercise 2

Derive the expected value and covariance matrix of the residual vector, $\hbe$. In other words, derive the $E[\hbe | \bX]$ and $\text{var}(\hbe | \bX)$.

Hint: consider the hat matrix.

## Exercise 3

Show that all eigenvalues of the hat matrix $\hatMatrix$ are 0 or 1.

## Exercise 4

Let $\by = \bX \beta + \epsilon$ where $\beta \in \mathbb{R}^p$ and $p = 2$.

(a) Show that $(I-\hatMatrix)$ is orthogonal to $Col(\bX)$. 

(b) Show $E\left[\frac{\text{RSS}}{n-2}| \bX \right]$ is an unbiased estimator of $\sigma^2$.

Hint: note the fact that $a = tr(a)$ for all scalar numbers $a$. Also note the cyclic property of trace: $tr(ABC) = tr(CAB) = tr(BCA)$.

## Exercise 5

Show that if $\bar{x} > 0$, $\text{cov}(\hat{\beta}_0, \hat{\beta}_1) < 0$ in simple linear regression.

## Exercise 6

Because the least squares estimator $\hat{\beta} = \bA \by$, for some matrix $\bA$, we call $\hat{\beta}$ a *linear* estimator.

If $E[\be | \bX] = \bzero$ and $\text{var}(\be | \bX) = \sigma^2 \identity$, then show (a) that $E[\hat{\beta}] = \beta$ and (b) that $\hat{\beta}$ has *the smallest* variance among all linear, unbiased estimators.

Hint for part (b): consider an alternative linear estimator $\tilde{\beta} = \boldsymbol{B} \by$ and show that its variance is equal to the variance of $\hat{\beta}$ plus some positive semi-definite matrix.


## Exercise 7

Describe, in your own words, the difference between $\hat{\beta}$ and $\beta$ as well as the difference between $\hat{y}$ and $y$. In your explanation, specifically identify whether each is *random* or *fixed*, *known* or *unknown* both before and after collecting the data.



# Submission

::: callout-warning
Remember -- you must turn in a PDF file to the Gradescope page before the submission deadline for full credit.

If you write your responses to conceptual exercises by hand, you will need to combine your written work to the completed PDF for the applied exercises before submitting on Gradescope.

Instructions to combine PDFs:

-   Preview (Mac): [support.apple.com/guide/preview/combine-pdfs-prvw43696/mac](https://support.apple.com/guide/preview/combine-pdfs-prvw43696/mac)

-   Adobe (Mac or PC): [helpx.adobe.com/acrobat/using/merging-files-single-pdf.html](https://helpx.adobe.com/acrobat/using/merging-files-single-pdf.html)

    -   Get free access to Adobe Acrobat as a Duke student: [oit.duke.edu/help/articles/kb0030141/](https://oit.duke.edu/help/articles/kb0030141/)
:::

To submit your assignment:

-   Access Gradescope through the menu on the Canvas website.

-   Click on the assignment, and you'll be prompted to submit it.

-   Mark the pages associated with each exercise. All of the pages of your lab should be associated with at least one question (i.e., should be “checked”).
